import{_ as $,r as a,o as ee,a4 as te,s as I,m as c,a5 as le,h as u,a as e,b as d,j as m,u as i,c as f,t as b,F as D,d as L,i as x,x as ae,S as z,D as oe,W as se,X as ie,a6 as ne,J as ce,y as de,z as re}from"./index-qTY0cfte.js";/* empty css                        */const p=y=>(de("data-v-82adf502"),y=y(),re(),y),ue={class:"mod-sys__log-login"},ve={class:"camera_top"},_e=p(()=>e("p",null,"提示：只允许重新上传未审核通过或者未上传的资料。",-1)),he={key:0,class:"camera_btn"},me={id:"v",autoplay:"true",ref:"video",width:"600px",height:"600px",style:{"aspect-ratio":"auto 600 / 600"}},pe={class:"btn_right"},ge={class:"con_item"},fe=p(()=>e("div",{class:"con_tit"},"考生姓名：",-1)),ye={class:"con_ipt"},we={class:"con_item"},ke=p(()=>e("div",{class:"con_tit"},"考生证件号：",-1)),Ce={class:"con_ipt"},be={class:"con_item"},xe=p(()=>e("div",{class:"con_tit"},"上传材料类型：",-1)),Ve={class:"con_ipt"},Se={class:"con_item"},Ee=p(()=>e("div",{class:"con_tit"},"摄像头：",-1)),Ie={class:"con_ipt"},De={class:"con_item"},Le=p(()=>e("div",{class:"con_tit"},"分辨率：",-1)),ze={class:"con_ipt"},Ue={class:"paizhao"},Be={class:"dialog-body"},Re={class:"shot-time"},Te={class:"dialog-footer"},je={__name:"index",setup(y){let V=a(!1),w=a({}),v=a(""),_=a("1280*960"),k=a([]),N=a([]),P=a([]);a([]);let F=a([{value:"1280*960"},{value:"1250*1000"},{value:"1000*800"},{value:"800*600"},{value:"640*480"}]),g=a(null),h=a([]),S=a([]),U=a(0),M=a(0),O=a(0),q=a(0),B=a(""),r=a(!1);ee(()=>{O.value="",q.value="",B.value="某材料",N.value=[],P.value=[],w.value={name:"方源",zjh:"418423245112046543"},console.log(w.value)}),te(()=>{R()});let A=()=>{r.value=!0},W=()=>{h.value=[],S.value=[],z.success("清空成功"),r.value=!1};const H=()=>{E()},J=async()=>{try{console.log("摄像头已打开"),V.value=!0,await X(),E()}catch(o){console.error("打开摄像头失败:",o)}},X=async()=>{try{if(!navigator.mediaDevices){alert("该浏览器不支持媒体设备");return}let t=(await navigator.mediaDevices.enumerateDevices()).filter(s=>s.kind==="videoinput");if(t.length==0)return z.warning("没有找到摄像头");console.log("摄像头列表",t),k.value=t.map(s=>({deviceId:s.deviceId,label:s.label||`摄像头 ${k.value.length+1}`})),v.value=k.value[0].deviceId}catch(o){console.error("获取摄像头列表失败:",o)}},R=()=>{g.value?(g.value.getTracks().forEach(o=>o.stop()),g.value=null,V.value=!1,console.log("摄像头已关闭")):console.log("没有打开的摄像头")},G=()=>{h.value.length>=1?confirm("您确定要继续拍照吗?")?T():(console.log("要提交的图片列表",h.value),z.success("提交数据")):T()},T=()=>{let o=document.querySelector("video");o.setAttribute("crossOrigin","anonymous");let t=document.createElement("canvas");const s=600/U.value;t.width=o.videoWidth*s,t.height=o.videoHeight*s,t.getContext("2d").drawImage(o,0,0,t.width,t.height);let n=t.toDataURL("image/png");h.value.push({time:new Date().toLocaleString(),image:n.split(",")[1]}),S.value.push(n),console.log(h.value)},E=async()=>{let o=_.value.split("*")[0],t=_.value.split("*")[1],s={video:{width:o,height:t,deviceId:v.value}};try{g.value=await navigator.mediaDevices.getUserMedia(s),K(g.value)}catch(n){n.name==="PermissionDeniedError"&&alert("浏览器调用摄像头失败，建议使用Chrome浏览器访问")}},K=o=>{const t=document.querySelector("video");t.srcObject=o;const n=o.getVideoTracks()[0].getSettings();console.log("分辨率已改变",n.width,"x",n.height),U.value=n.width,M.value=n.height,t.play()};return(o,t)=>{const s=oe,n=se,j=ie,Q=ne,Y=ce,Z=le;return u(),I(Z,{shadow:"never",class:"aui-card--fill"},{default:c(()=>[e("div",ue,[e("div",ve,[_e,e("div",null,[d(s,{type:"primary",onClick:J},{default:c(()=>[m("打开摄像头")]),_:1}),d(s,{type:"warning",style:{"margin-left":"20px"},onClick:R},{default:c(()=>[m("关闭摄像头")]),_:1})])]),i(V)?(u(),f("div",he,[e("div",null,[e("video",me,null,512)]),e("div",pe,[e("div",ge,[fe,e("div",ye,b(i(w).name),1)]),e("div",we,[ke,e("div",Ce,b(i(w).zjh),1)]),e("div",be,[xe,e("div",Ve,b(i(B)),1)]),e("div",Se,[Ee,e("div",Ie,[d(j,{modelValue:i(v),"onUpdate:modelValue":t[0]||(t[0]=l=>x(v)?v.value=l:v=l),placeholder:"请选择摄像头",clearable:"",onChange:H},{default:c(()=>[(u(!0),f(D,null,L(i(k),(l,C)=>(u(),I(n,{key:l.deviceId,label:l.label,value:l.deviceId},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])])]),e("div",De,[Le,e("div",ze,[d(j,{modelValue:i(_),"onUpdate:modelValue":t[1]||(t[1]=l=>x(_)?_.value=l:_=l),placeholder:"请选择分辨率",clearable:"",onChange:E},{default:c(()=>[(u(!0),f(D,null,L(i(F),(l,C)=>(u(),I(n,{key:l.value,label:l.value,value:l.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])])]),e("div",Ue,[d(s,{type:"primary",onClick:G},{default:c(()=>[m("拍照")]),_:1}),d(s,{type:"primary",onClick:i(A)},{default:c(()=>[m("查看照片")]),_:1},8,["onClick"])])])])):ae("",!0)]),d(Y,{modelValue:i(r),"onUpdate:modelValue":t[3]||(t[3]=l=>x(r)?r.value=l:r=l),title:"查看照片",width:"730",draggable:""},{footer:c(()=>[e("div",Te,[d(s,{onClick:t[2]||(t[2]=l=>x(r)?r.value=!1:r=!1)},{default:c(()=>[m("关闭")]),_:1}),d(s,{type:"primary",onClick:i(W)},{default:c(()=>[m("清空照片")]),_:1},8,["onClick"])])]),default:c(()=>[e("div",Be,[(u(!0),f(D,null,L(i(h),(l,C)=>(u(),f("div",{key:C,class:"shot-item"},[e("div",Re,b(l.time),1),d(Q,{src:"data:image/png;base64,"+l.image,class:"shot-img","preview-src-list":i(S),"initial-index":C,fit:"cover"},null,8,["src","preview-src-list","initial-index"])]))),128))])]),_:1},8,["modelValue"])]),_:1})}}},Fe=$(je,[["__scopeId","data-v-82adf502"]]);export{Fe as default};
